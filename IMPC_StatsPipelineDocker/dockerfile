FROM rocker/r-ver:4.0.2

# ARG WHEN

WORKDIR /IMPC_SP

RUN apt-get -y update

# Magick++
RUN apt-get -y install build-essential
ADD https://www.imagemagick.org/download/ImageMagick.tar.gz ImageMagick.tar.gz
#RUN mkdir -p ImageMagick
RUN tar xvzf ImageMagick.tar.gz 
WORKDIR ImageMagick-7.0.10-27
#RUN cd ImageMagick-7.0.10-27
RUN echo $(ls -ah)
RUN chmod 775 configure
RUN ./configure
RUN make
RUN make install 

# XML package
#RUN apt-get -y purge -f libxml2-dev
#RUN apt-get -y clean
RUN apt-get -y install libxml2 libxml2-dev

# GSL package
RUN apt install -y libgsl-dev

# zlib
RUN apt-get -y install zlib1g libncurses5


RUN R -e "install.packages('data.table',repos='https://cloud.r-project.org')"

 
# RUN wget https://raw.githubusercontent.com/mpi2/impc_stats_pipeline/master/impc_statistical_pipeline/install_dependencies.R
# RUN Rscript "install_dependencies.R"
RUN R -e "source('https://raw.githubusercontent.com/mpi2/impc_stats_pipeline/master/impc_statistical_pipeline/install_dependencies.R')"

# Make the home directory
# RUN mkdir -p ~/IMPCStatsPipeline/jobs
# CMD cd ~/IMPCStatsPipeline/jobs
# RUN mkdir ~/mydocker/results 
# docker run -v ~/mydocker/results:/home/IMPCStatsPipeline  analysis
